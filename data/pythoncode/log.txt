/home/louis/miniconda3/envs/autocode/bin/python /home/louis/Documents/Projects/autocode/src/gpt2_data_preprocessor.py
Shard 0:  99%|█████████▉| 99147357/100000000 [00:39<00:00, 4545648.70tokens/s]Doc count:  655296
Shard 0: 100%|██████████| 100000000/100000000 [00:39<00:00, 2512961.88tokens/s]
Shard 1: 100%|█████████▉| 99688614/100000000 [00:41<00:00, 3181601.70tokens/s]Doc count:  1323408
Shard 1: 100%|█████████▉| 99999615/100000000 [00:41<00:00, 2413350.44tokens/s]
Shard 2: 100%|█████████▉| 99769255/100000000 [00:42<00:00, 3847287.40tokens/s]Doc count:  2083088
Shard 2: 100%|█████████▉| 99999896/100000000 [00:43<00:00, 2325059.64tokens/s]
Shard 3:  97%|█████████▋| 96763825/100000000 [00:34<00:00, 3804507.02tokens/s]Doc count:  2724880
Shard 3: 100%|█████████▉| 99999625/100000000 [00:37<00:00, 2683308.50tokens/s]
Shard 4: 100%|█████████▉| 99977170/100000000 [00:43<00:00, 2457498.79tokens/s]Doc count:  3417232
Shard 4: 100%|█████████▉| 99996320/100000000 [00:43<00:00, 2307211.89tokens/s]
Shard 5: 100%|█████████▉| 99799817/100000000 [00:50<00:00, 4416653.06tokens/s]Doc count:  4161552
Shard 5: 100%|█████████▉| 99993691/100000000 [00:50<00:00, 1968653.68tokens/s]
Shard 6:  99%|█████████▉| 99417775/100000000 [00:50<00:00, 2447737.95tokens/s]Doc count:  4843520
Shard 6: 100%|█████████▉| 99993597/100000000 [00:50<00:00, 1988534.24tokens/s]
Shard 7: 100%|█████████▉| 99746435/100000000 [00:50<00:00, 2846450.80tokens/s]Doc count:  5514800
Shard 7: 100%|█████████▉| 99992621/100000000 [00:50<00:00, 1990112.39tokens/s]
Shard 8: 100%|█████████▉| 99691551/100000000 [00:42<00:00, 2059069.52tokens/s]Doc count:  6263648
Shard 8: 100%|█████████▉| 99999205/100000000 [00:42<00:00, 2337184.20tokens/s]
Shard 9: 100%|█████████▉| 99634198/100000000 [00:45<00:00, 2029960.90tokens/s]Doc count:  6934368
Shard 9: 100%|█████████▉| 99979787/100000000 [00:45<00:00, 2199111.57tokens/s]
Shard 10: 100%|█████████▉| 99662072/100000000 [00:53<00:00, 5725519.75tokens/s]Doc count:  7609536
Shard 10: 100%|█████████▉| 99993101/100000000 [00:53<00:00, 1876160.20tokens/s]
Shard 11: 100%|█████████▉| 99776096/100000000 [00:51<00:00, 4222649.53tokens/s]Doc count:  8332128
Shard 11: 100%|█████████▉| 99983305/100000000 [00:52<00:00, 1922657.36tokens/s]
Shard 12:  99%|█████████▉| 98865509/100000000 [00:46<00:01, 840120.48tokens/s]Doc count:  9019552
Shard 12: 100%|█████████▉| 99943137/100000000 [00:46<00:00, 2139545.53tokens/s]
Shard 13: 100%|█████████▉| 99530778/100000000 [00:50<00:00, 3845979.58tokens/s]Doc count:  9689216
Shard 13: 100%|█████████▉| 99999656/100000000 [00:50<00:00, 1960984.69tokens/s]
Shard 14:  99%|█████████▉| 99381212/100000000 [00:49<00:00, 2061978.55tokens/s]Doc count:  10411744
Shard 14: 100%|█████████▉| 99995880/100000000 [00:49<00:00, 2011740.68tokens/s]
Shard 15: 100%|█████████▉| 99627277/100000000 [00:55<00:00, 1205637.19tokens/s]Doc count:  11078784
Shard 15: 100%|█████████▉| 99999379/100000000 [00:55<00:00, 1793546.06tokens/s]
Shard 16: 100%|█████████▉| 99653610/100000000 [00:45<00:00, 4137683.57tokens/s]Doc count:  11765440
Shard 16: 100%|█████████▉| 99998950/100000000 [00:45<00:00, 2189246.09tokens/s]
Shard 17: 100%|█████████▉| 99692681/100000000 [00:46<00:00, 1605099.47tokens/s]Doc count:  12483232
Shard 17: 100%|█████████▉| 99999683/100000000 [00:46<00:00, 2155930.33tokens/s]
Shard 18:  99%|█████████▉| 99367638/100000000 [00:49<00:00, 2533499.26tokens/s]Doc count:  13137696
Shard 18: 100%|█████████▉| 99801874/100000000 [00:49<00:00, 2016046.11tokens/s]
Shard 19: 100%|█████████▉| 99715922/100000000 [00:48<00:00, 4562843.35tokens/s]Doc count:  13821568
Shard 19: 100%|█████████▉| 99998692/100000000 [00:48<00:00, 2053274.78tokens/s]
Shard 20:  99%|█████████▉| 99333985/100000000 [00:51<00:00, 2048548.58tokens/s]Doc count:  14559744
Shard 20: 100%|█████████▉| 99994883/100000000 [00:52<00:00, 1920676.98tokens/s]
Shard 21:  39%|███▉      | 39013633/100000000 [01:25<40:47, 24914.33tokens/s]  Doc count:  15227184
Shard 21: 100%|█████████▉| 99891454/100000000 [01:25<00:00, 1167909.78tokens/s]
Shard 22: 100%|█████████▉| 99735141/100000000 [00:21<00:00, 1343151.85tokens/s]Doc count:  15908960
Shard 22: 100%|█████████▉| 99995508/100000000 [00:22<00:00, 4512963.89tokens/s]
Shard 23: 100%|█████████▉| 99781354/100000000 [00:48<00:00, 1959848.44tokens/s]Doc count:  16632096
Shard 23: 100%|█████████▉| 99999412/100000000 [00:48<00:00, 2057402.86tokens/s]
Shard 24:  99%|█████████▉| 99451567/100000000 [00:44<00:00, 2230565.63tokens/s]Doc count:  17298976
Shard 24: 100%|█████████▉| 99998216/100000000 [00:44<00:00, 2257261.28tokens/s]
Shard 25: 100%|█████████▉| 99883732/100000000 [00:51<00:00, 1062534.01tokens/s]Doc count:  17973824
Shard 25: 100%|█████████▉| 99998760/100000000 [00:51<00:00, 1923426.62tokens/s]
Shard 26:  69%|██████▊   | 68719065/100000000 [00:56<08:31, 61116.14tokens/s]  Doc count:  18699264
Shard 26: 100%|█████████▉| 99999172/100000000 [00:57<00:00, 1754109.99tokens/s]
Shard 27: 100%|█████████▉| 99842110/100000000 [00:41<00:00, 4807716.39tokens/s]Doc count:  19367616
Shard 27: 100%|█████████▉| 99999295/100000000 [00:41<00:00, 2429497.18tokens/s]
Shard 28:  99%|█████████▉| 99350499/100000000 [00:48<00:00, 2565389.86tokens/s]Doc count:  20049408
Shard 28: 100%|█████████▉| 99989390/100000000 [00:48<00:00, 2056643.04tokens/s]
Shard 29:  99%|█████████▉| 99031747/100000000 [00:47<00:00, 1869927.74tokens/s]Doc count:  20779824
Shard 29: 100%|█████████▉| 99997034/100000000 [00:47<00:00, 2112418.00tokens/s]
Shard 30:  98%|█████████▊| 98181647/100000000 [00:40<00:00, 2110896.20tokens/s]Doc count:  21436064
Shard 30: 100%|█████████▉| 99975308/100000000 [00:40<00:00, 2479275.44tokens/s]
Shard 31:  99%|█████████▉| 99142621/100000000 [00:50<00:00, 2092826.97tokens/s]Doc count:  22103520
Shard 31: 100%|█████████▉| 99894687/100000000 [00:51<00:00, 1956970.48tokens/s]
Shard 32: 100%|█████████▉| 99589911/100000000 [00:51<00:00, 1818718.75tokens/s]Doc count:  22830000
Shard 32: 100%|█████████▉| 99956691/100000000 [00:51<00:00, 1935013.86tokens/s]
Shard 33:  99%|█████████▉| 98881462/100000000 [00:41<00:00, 4838432.97tokens/s]Doc count:  23474752
Shard 33: 100%|█████████▉| 99994413/100000000 [00:41<00:00, 2387134.78tokens/s]
Shard 34: 100%|█████████▉| 99787131/100000000 [00:57<00:00, 2861859.40tokens/s]Doc count:  24157744
Shard 34: 100%|█████████▉| 99999684/100000000 [00:58<00:00, 1720357.60tokens/s]
Shard 35: 100%|█████████▉| 99729059/100000000 [00:56<00:00, 4518389.04tokens/s]Doc count:  24890112
Shard 35: 100%|█████████▉| 99935110/100000000 [00:56<00:00, 1764056.26tokens/s]
Shard 36:  99%|█████████▉| 98976393/100000000 [00:53<00:00, 1910023.45tokens/s]Doc count:  25545760
Shard 36: 100%|█████████▉| 99999409/100000000 [00:53<00:00, 1879792.96tokens/s]
Shard 37:  99%|█████████▉| 99379358/100000000 [00:49<00:00, 1633047.36tokens/s]Doc count:  26223376
Shard 37: 100%|█████████▉| 99996014/100000000 [00:49<00:00, 2022504.95tokens/s]
Shard 38: 100%|█████████▉| 99986073/100000000 [00:56<00:00, 2274787.38tokens/s]Doc count:  26944352
Shard 38: 100%|█████████▉| 99999791/100000000 [00:56<00:00, 1767001.18tokens/s]
Shard 39: 100%|█████████▉| 99991269/100000000 [01:03<00:00, 1023215.22tokens/s]Doc count:  27564496
Shard 39: 100%|█████████▉| 99991269/100000000 [01:03<00:00, 1573301.38tokens/s]
Shard 40:  99%|█████████▉| 98961055/100000000 [00:52<00:00, 1361963.66tokens/s]Doc count:  28240672
Shard 40: 100%|█████████▉| 99600375/100000000 [00:53<00:00, 1874288.47tokens/s]
Shard 41:  99%|█████████▉| 99037323/100000000 [00:57<00:00, 2275064.04tokens/s]Doc count:  28980944
Shard 41: 100%|█████████▉| 99997453/100000000 [00:57<00:00, 1742010.02tokens/s]
Shard 42: 100%|█████████▉| 99795696/100000000 [00:52<00:00, 3071643.18tokens/s]Doc count:  29628432
Shard 42: 100%|█████████▉| 99998346/100000000 [00:52<00:00, 1899448.50tokens/s]
Shard 43: 100%|█████████▉| 99530422/100000000 [00:45<00:00, 1543594.69tokens/s]Doc count:  30316048
Shard 43: 100%|█████████▉| 99998530/100000000 [00:46<00:00, 2168720.21tokens/s]
Shard 44:  98%|█████████▊| 98004459/100000000 [00:49<00:01, 1481902.84tokens/s]Doc count:  31061728
Shard 44: 100%|█████████▉| 99930646/100000000 [00:50<00:00, 1997807.24tokens/s]
Shard 45: 100%|█████████▉| 99631468/100000000 [00:54<00:00, 2207625.10tokens/s]Doc count:  31721152
Shard 45: 100%|█████████▉| 99999955/100000000 [00:54<00:00, 1841205.16tokens/s]
Shard 46:  99%|█████████▉| 98895853/100000000 [00:48<00:00, 2375517.82tokens/s]Doc count:  32383584
Shard 46: 100%|█████████▉| 99994650/100000000 [00:48<00:00, 2068969.88tokens/s]
Shard 47: 100%|█████████▉| 99618148/100000000 [00:49<00:00, 2347399.76tokens/s]Doc count:  33099984
Shard 47: 100%|█████████▉| 99996924/100000000 [00:49<00:00, 2017689.39tokens/s]
Shard 48: 100%|█████████▉| 99854731/100000000 [00:59<00:00, 2014389.30tokens/s]Doc count:  33738320
Shard 48: 100%|█████████▉| 99902608/100000000 [01:00<00:00, 1661064.33tokens/s]
Shard 49: 100%|█████████▉| 99777352/100000000 [01:11<00:00, 1532455.94tokens/s]Doc count:  34419040
Shard 49: 100%|█████████▉| 99995927/100000000 [01:12<00:00, 1388035.25tokens/s]
Shard 50:  99%|█████████▉| 99062479/100000000 [01:00<00:00, 2795782.76tokens/s]Doc count:  35165328
Shard 50: 100%|█████████▉| 99924930/100000000 [01:00<00:00, 1650508.95tokens/s]
Shard 51: 100%|█████████▉| 99861230/100000000 [00:53<00:00, 3180436.64tokens/s]Doc count:  35794048
Shard 51: 100%|█████████▉| 99997657/100000000 [00:53<00:00, 1879633.30tokens/s]
Shard 52: 100%|█████████▉| 99604007/100000000 [00:47<00:00, 1525229.91tokens/s]Doc count:  36474080
Shard 52: 100%|█████████▉| 99985248/100000000 [00:47<00:00, 2083637.91tokens/s]
Shard 53: 100%|█████████▉| 99977355/100000000 [00:44<00:00, 938099.24tokens/s] Doc count:  37207456
Shard 53: 100%|█████████▉| 99977355/100000000 [00:44<00:00, 2258390.30tokens/s]
Shard 54: 100%|█████████▉| 99506362/100000000 [00:47<00:00, 5447995.63tokens/s]Doc count:  37879584
Shard 54: 100%|█████████▉| 99987881/100000000 [00:48<00:00, 2043903.64tokens/s]
Shard 55:  97%|█████████▋| 97494015/100000000 [00:47<00:01, 1814179.25tokens/s]Doc count:  38570832
Shard 55: 100%|█████████▉| 99993313/100000000 [00:47<00:00, 2093689.59tokens/s]
Shard 56: 100%|█████████▉| 99630209/100000000 [00:56<00:00, 1870675.11tokens/s]Doc count:  39295648
Shard 56: 100%|█████████▉| 99999529/100000000 [00:56<00:00, 1776109.89tokens/s]
Shard 57: 100%|█████████▉| 99564218/100000000 [00:57<00:00, 1439602.98tokens/s]Doc count:  39938832
Shard 57: 100%|█████████▉| 99998819/100000000 [00:57<00:00, 1729819.10tokens/s]
Shard 58: 100%|█████████▉| 99673968/100000000 [00:45<00:00, 2130198.68tokens/s]Doc count:  40629152
Shard 58: 100%|█████████▉| 99995312/100000000 [00:45<00:00, 2200657.45tokens/s]
Shard 59: 100%|█████████▉| 99620692/100000000 [00:46<00:00, 2943433.01tokens/s]Doc count:  41348064
Shard 59: 100%|█████████▉| 99999753/100000000 [00:46<00:00, 2144737.87tokens/s]
Shard 60: 100%|█████████▉| 99913897/100000000 [00:51<00:00, 2558785.09tokens/s]Doc count:  41979968
Shard 60: 100%|█████████▉| 99995743/100000000 [00:51<00:00, 1933116.95tokens/s]
Shard 61: 100%|█████████▉| 99691798/100000000 [00:54<00:00, 1050073.29tokens/s]Doc count:  42665376
Shard 61: 100%|█████████▉| 99990785/100000000 [00:54<00:00, 1833576.19tokens/s]
Shard 62: 100%|█████████▉| 99976503/100000000 [01:00<00:00, 4498322.19tokens/s]Doc count:  43394688
Shard 62: 100%|█████████▉| 99988027/100000000 [01:00<00:00, 1643173.09tokens/s]
Shard 63: 100%|█████████▉| 99587652/100000000 [00:54<00:00, 2156077.10tokens/s]Doc count:  44059792
Shard 63: 100%|█████████▉| 99999532/100000000 [00:54<00:00, 1830557.81tokens/s]
Shard 64:  99%|█████████▉| 99297651/100000000 [00:55<00:00, 1102755.33tokens/s]Doc count:  44722704
Shard 64: 100%|█████████▉| 99997995/100000000 [00:55<00:00, 1803438.15tokens/s]
Shard 65:  71%|███████   | 70843971/100000000 [01:29<00:28, 1012954.97tokens/s]Doc count:  45425232
Shard 65: 100%|█████████▉| 99999535/100000000 [01:29<00:00, 1116288.86tokens/s]
Shard 66:  95%|█████████▍| 94959846/100000000 [00:13<00:01, 4968588.31tokens/s]Doc count:  46066336
Shard 66: 100%|█████████▉| 99990394/100000000 [00:17<00:00, 5701424.88tokens/s]
Shard 67:  99%|█████████▉| 99331270/100000000 [00:47<00:00, 3512059.42tokens/s]Doc count:  46773904
Shard 67: 100%|█████████▉| 99995924/100000000 [00:47<00:00, 2088862.81tokens/s]
Shard 68: 100%|█████████▉| 99859140/100000000 [00:43<00:00, 2269258.85tokens/s]Doc count:  47468640
Shard 68: 100%|█████████▉| 99989887/100000000 [00:43<00:00, 2285199.77tokens/s]
Shard 69: 100%|█████████▉| 99758440/100000000 [00:46<00:00, 1373955.36tokens/s]Doc count:  48142624
Shard 69: 100%|█████████▉| 99999315/100000000 [00:46<00:00, 2151862.40tokens/s]
Shard 70: 100%|█████████▉| 99755278/100000000 [00:48<00:00, 1891802.94tokens/s]Doc count:  48848672
Shard 70: 100%|█████████▉| 99996106/100000000 [00:48<00:00, 2048418.18tokens/s]
Shard 71:  99%|█████████▉| 99449060/100000000 [00:44<00:00, 1990068.22tokens/s]Doc count:  49568848
Shard 71: 100%|█████████▉| 99996159/100000000 [00:44<00:00, 2245584.44tokens/s]
Shard 72: 100%|█████████▉| 99843618/100000000 [00:54<00:00, 2014301.03tokens/s]Doc count:  50233856
Shard 72: 100%|█████████▉| 99999384/100000000 [00:54<00:00, 1822796.37tokens/s]
Shard 73: 100%|█████████▉| 99731000/100000000 [00:47<00:00, 1980205.92tokens/s]Doc count:  50932704
Shard 73: 100%|█████████▉| 99999788/100000000 [00:47<00:00, 2105806.74tokens/s]
Shard 74:  99%|█████████▉| 98878715/100000000 [00:49<00:00, 2012008.02tokens/s]Doc count:  51635776
Shard 74: 100%|█████████▉| 99940566/100000000 [00:50<00:00, 1993326.69tokens/s]
Shard 75: 100%|█████████▉| 99684520/100000000 [00:46<00:00, 4123416.91tokens/s]Doc count:  52288608
Shard 75: 100%|█████████▉| 99995632/100000000 [00:46<00:00, 2134272.63tokens/s]
Shard 76:  99%|█████████▉| 99479229/100000000 [00:39<00:00, 2706070.45tokens/s]Doc count:  52990704
Shard 76: 100%|█████████▉| 99999275/100000000 [00:39<00:00, 2504562.45tokens/s]
Shard 77: 100%|█████████▉| 99540489/100000000 [00:44<00:00, 1761492.48tokens/s]Doc count:  53712656
Shard 77: 100%|█████████▉| 99999826/100000000 [00:44<00:00, 2247032.91tokens/s]
Shard 78:  99%|█████████▉| 99370865/100000000 [00:46<00:00, 4743708.30tokens/s]Doc count:  54365680
Shard 78: 100%|█████████▉| 99968422/100000000 [00:46<00:00, 2160210.06tokens/s]
Shard 79: 100%|█████████▉| 99953193/100000000 [00:45<00:00, 4217780.62tokens/s]Doc count:  55037536
Shard 79: 100%|█████████▉| 99993100/100000000 [00:45<00:00, 2191290.99tokens/s]
Shard 80:  89%|████████▉ | 89444245/100000000 [00:40<00:09, 1121762.31tokens/s]thread '<unnamed>' panicked at src/lib.rs:191:29:
called `Result::unwrap()` on an `Err` value: RuntimeError(StackOverflow)
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
Process ForkPoolWorker-3:
Traceback (most recent call last):
  File "/home/louis/miniconda3/envs/autocode/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/louis/miniconda3/envs/autocode/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/louis/miniconda3/envs/autocode/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/home/louis/miniconda3/envs/autocode/lib/python3.10/multiprocessing/pool.py", line 48, in mapstar
    return list(map(*args))
  File "/home/louis/Documents/Projects/autocode/src/gpt2_data_preprocessor.py", line 37, in tokenize
    tokens.extend(enc.encode_ordinary(doc["content"]))
  File "/home/louis/miniconda3/envs/autocode/lib/python3.10/site-packages/tiktoken/core.py", line 69, in encode_ordinary
    return self._core_bpe.encode_ordinary(text)
pyo3_runtime.PanicException: called `Result::unwrap()` on an `Err` value: RuntimeError(StackOverflow)
Shard 80:  90%|████████▉ | 89688297/100000000 [00:52<00:09, 1121762.31tokens/s]